<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Clock Explorer</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #007bff; --bg: #f8fafc; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: -apple-system, system-ui, sans-serif; overflow: hidden; background: var(--bg); }

        /* CONTROLS HEADER */
        .header {
            position: fixed; top: 0; left: 0; width: 100%; height: 60px;
            background: #fff; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-sizing: border-box;
        }

        .title { font-weight: 800; font-size: 1.2rem; color: #1e293b; text-transform: uppercase; letter-spacing: -0.025em; }

        .btn-group { display: flex; background: #f1f3f5; padding: 4px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .btn-group button {
            border: none; padding: 6px 12px; border-radius: 6px; background: transparent;
            font-size: 12px; font-weight: 700; color: #64748b; cursor: pointer; transition: 0.2s;
            white-space: nowrap;
        }
        .btn-group button.active { background: #fff; color: var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* MAP AREA */
        #map { height: calc(100vh - 110px); width: 100%; margin-top: 60px; z-index: 1; }

        .clock-marker {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 4px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-width: 80px;
        }
        .clock-city { font-size: 9px; text-transform: uppercase; color: #64748b; margin-bottom: 2px; }
        .clock-time { font-size: 14px; color: #1e293b; font-variant-numeric: tabular-nums; }

        .nav-bar {
            position: fixed; bottom: 0; width: 100%; background: #fff; border-top: 1px solid #ddd;
            display: flex; justify-content: space-around; padding: 10px 0; z-index: 1000;
        }
        .nav-bar a {
            color: #64748b; text-decoration: none; font-size: 12px; font-weight: 700;
            display: flex; flex-direction: column; align-items: center; gap: 4px;
        }
        .nav-bar a.active { color: var(--primary); }
    </style>
</head>
<body>
    <div class="header">
        <div class="title">Global Clock Map</div>
        <div class="btn-group">
            <button onclick="toggleFormat(false)" id="fmt-12" class="active">12H</button>
            <button onclick="toggleFormat(true)" id="fmt-24">24H</button>
        </div>
    </div>

    <div id="map"></div>

    <nav class="nav-bar">
        <a href="worldclock.html"><span>üïí</span>List</a>
        <a href="clockmap.html" class="active"><span>üó∫Ô∏è</span>Map</a>
    </nav>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const LOCATIONS = [
            { name: "New York", tz: "America/New_York", lat: 40.7128, lon: -74.0060 },
            { name: "London", tz: "Europe/London", lat: 51.5074, lon: -0.1278 },
            { name: "Paris", tz: "Europe/Paris", lat: 48.8566, lon: 2.3522 },
            { name: "Berlin", tz: "Europe/Berlin", lat: 52.5200, lon: 13.4050 },
            { name: "Moscow", tz: "Europe/Moscow", lat: 55.7558, lon: 37.6173 },
            { name: "Dubai", tz: "Asia/Dubai", lat: 25.2048, lon: 55.2708 },
            { name: "Mumbai", tz: "Asia/Kolkata", lat: 19.0760, lon: 72.8777 },
            { name: "Singapore", tz: "Asia/Singapore", lat: 1.3521, lon: 103.8198 },
            { name: "Tokyo", tz: "Asia/Tokyo", lat: 35.6762, lon: 139.6503 },
            { name: "Sydney", tz: "Australia/Sydney", lat: -33.8688, lon: 151.2093 },
            { name: "Los Angeles", tz: "America/Los_Angeles", lat: 34.0522, lon: -118.2437 },
            { name: "Chicago", tz: "America/Chicago", lat: 41.8781, lon: -87.6298 },
            { name: "Mexico City", tz: "America/Mexico_City", lat: 19.4326, lon: -99.1332 },
            { name: "Sao Paulo", tz: "America/Sao_Paulo", lat: -23.5505, lon: -46.6333 },
            { name: "Cairo", tz: "Africa/Cairo", lat: 30.0444, lon: 31.2357 },
            { name: "Johannesburg", tz: "Africa/Johannesburg", lat: -26.2041, lon: 28.0473 },
            { name: "Honolulu", tz: "Pacific/Honolulu", lat: 21.3069, lon: -157.8583 },
            { name: "Anchorage", tz: "America/Anchorage", lat: 61.2181, lon: -149.9003 },
            { name: "Hong Kong", tz: "Asia/Hong_Kong", lat: 22.3193, lon: 114.1694 },
            { name: "Bangkok", tz: "Asia/Bangkok", lat: 13.7563, lon: 100.5018 },
            { name: "Seoul", tz: "Asia/Seoul", lat: 37.5665, lon: 126.9780 },
            { name: "Rome", tz: "Europe/Rome", lat: 41.9028, lon: 12.4964 },
            { name: "Madrid", tz: "Europe/Madrid", lat: 40.4168, lon: -3.7038 },
            { name: "Istanbul", tz: "Europe/Istanbul", lat: 41.0082, lon: 28.9784 }
        ];

        let is24Hour = false;
        const markers = [];

        const map = L.map('map', { zoomSnap: 0.5 }).setView([20, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        function formatTime(tz) {
            return new Intl.DateTimeFormat('en-US', {
                timeZone: tz,
                hour: '2-digit',
                minute: '2-digit',
                hour12: !is24Hour
            }).format(new Date());
        }

        function createMarkers() {
            LOCATIONS.forEach(loc => {
                const icon = L.divIcon({
                    className: '',
                    html: `
                        <div class="clock-marker" id="clock-${loc.name.replace(/\s+/g, '')}">
                            <div class="clock-city">${loc.name}</div>
                            <div class="clock-time">${formatTime(loc.tz)}</div>
                        </div>
                    `,
                    iconSize: [100, 40],
                    iconAnchor: [50, 20]
                });

                const marker = L.marker([loc.lat, loc.lon], { icon }).addTo(map);
                markers.push({ marker, loc });
            });
        }

        function updateClocks() {
            markers.forEach(({ marker, loc }) => {
                const element = document.querySelector(`#clock-${loc.name.replace(/\s+/g, '')} .clock-time`);
                if (element) {
                    element.innerText = formatTime(loc.tz);
                }
            });
        }

        function toggleFormat(val) {
            is24Hour = val;
            document.getElementById('fmt-12').classList.toggle('active', !is24Hour);
            document.getElementById('fmt-24').classList.toggle('active', is24Hour);
            updateClocks();
        }

        createMarkers();
        setInterval(updateClocks, 1000);
    </script>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
  <title>MLB Diamond | Gameday</title>
  <style>
    :root {
      --bg: #0f172a;
      --surface: #1e293b;
      --card: #334155;
      --accent: #3b82f6;
      --text: #f8fafc;
      --muted: #94a3b8;
      --border: #475569;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --field-grass: #1b4332;
      --field-dirt: #7f4f24;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      overflow-x: hidden;
    }

    header {
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      padding: 12px 0;
    }

    .header-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .brand {
      font-size: 20px;
      font-weight: 900;
      background: linear-gradient(to right, #fb7185, #f43f5e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-controls { display: flex; align-items: center; gap: 8px; }
    .btn {
      background: var(--surface); border: 1px solid var(--border); color: var(--text);
      padding: 8px 12px; border-radius: 8px; cursor: pointer; font-weight: 700; font-size: 14px;
    }
    .btn:hover { background: var(--card); }
    
    #dateDisplay { font-weight: 800; color: var(--accent); min-width: 100px; text-align: center; }

    /* Field Layout */
    .field-container {
      position: relative;
      width: 100%;
      max-width: 1200px;
      margin: 20px auto;
      aspect-ratio: 1 / 1;
      background: radial-gradient(circle at 50% 50%, #2d6a4f 0%, #1b4332 100%);
      border-radius: 20px;
      overflow: hidden;
      border: 4px solid var(--border);
    }

    .diamond-svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    /* Zones for Game Cards */
    .zone {
      position: absolute;
      z-index: 10;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      width: 250px;
      justify-content: center;
      align-content: flex-start;
    }

    /* Zone Positions */
    .zone-1st { top: 45%; right: 2%; transform: translateY(-50%); } /* 1-3 innings */
    .zone-2nd { top: 5%; left: 50%; transform: translateX(-50%); } /* 4-6 innings */
    .zone-3rd { top: 45%; left: 2%; transform: translateY(-50%); } /* 7-9+ innings */
    .zone-post { bottom: 5%; left: 5%; } /* Finished - Left of Home */
    .zone-pre { bottom: 5%; right: 5%; } /* Yet to start - Right of Home */

    .zone-label {
      width: 100%;
      text-align: center;
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,0.6);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 5px;
      background: rgba(0,0,0,0.3);
      padding: 2px 0;
      border-radius: 4px;
    }

    .game-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 8px;
      width: 115px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
      transition: transform 0.2s;
      cursor: pointer;
    }
    .game-card:hover { transform: scale(1.05); border-color: var(--accent); }

    .team-line { display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px; }
    .team-logo { width: 20px; height: 20px; object-fit: contain; background: white; border-radius: 3px; padding: 1px; }
    .team-abbr { font-size: 11px; font-weight: 800; margin-left: 5px; flex-grow: 1; }
    .score { font-size: 13px; font-weight: 900; font-variant-numeric: tabular-nums; }
    .status-line { 
      font-size: 9px; 
      font-weight: 800; 
      color: var(--muted); 
      text-align: center; 
      border-top: 1px solid var(--border); 
      padding-top: 4px;
      margin-top: 4px;
    }
    .live { color: var(--danger); }

    @media (max-width: 800px) {
      .field-container { aspect-ratio: auto; height: auto; min-height: 1200px; display: flex; flex-direction: column; gap: 40px; padding: 20px; }
      .zone { position: static; width: 100%; transform: none; }
      .diamond-svg { display: none; }
    }
  </style>
</head>
<body>

  <header>
    <div class="header-container">
      <div class="brand">MLB DIAMOND</div>
      <div class="nav-controls">
        <button class="btn" onclick="changeDate(-1)">←</button>
        <div id="dateDisplay"></div>
        <button class="btn" onclick="changeDate(1)">→</button>
        <button class="btn" style="margin-left:10px;" onclick="location.reload()">⟳</button>
      </div>
    </div>
  </header>

  <main>
    <div class="field-container" id="field">
      <!-- SVG Drawing of the Field -->
      <svg class="diamond-svg" viewBox="0 0 1000 1000">
        <!-- Infield Dirt Diamond -->
        <path d="M 500 850 L 850 500 L 500 150 L 150 500 Z" fill="#7f4f24" />
        <!-- Base Paths -->
        <path d="M 500 850 L 850 500 L 500 150 L 150 500 Z" fill="none" stroke="#e9ecef" stroke-width="4" stroke-dasharray="10 10" />
        
        <!-- Bases -->
        <rect x="480" y="830" width="40" height="40" fill="white" /> <!-- Home -->
        <rect x="830" y="480" width="40" height="40" fill="white" transform="rotate(45 850 500)" /> <!-- 1st -->
        <rect x="480" y="130" width="40" height="40" fill="white" transform="rotate(45 500 150)" /> <!-- 2nd -->
        <rect x="130" y="480" width="40" height="40" fill="white" transform="rotate(45 150 500)" /> <!-- 3rd -->
        
        <!-- Pitcher's Mound -->
        <circle cx="500" cy="500" r="30" fill="#7f4f24" stroke="#e9ecef" stroke-width="2" />
      </svg>

      <div class="zone zone-1st" id="zone-1-3"><div class="zone-label">Innings 1-3</div></div>
      <div class="zone zone-2nd" id="zone-4-6"><div class="zone-label">Innings 4-6</div></div>
      <div class="zone zone-3rd" id="zone-7-9"><div class="zone-label">Innings 7-9+</div></div>
      <div class="zone zone-post" id="zone-post"><div class="zone-label">Final Games</div></div>
      <div class="zone zone-pre" id="zone-pre"><div class="zone-label">Scheduled</div></div>
    </div>
  </main>

  <script>
    let currentDate = new Date();

    function changeDate(delta) {
      currentDate.setDate(currentDate.getDate() + delta);
      fetchGames();
    }

    function getFormattedDate(date) {
      const y = date.getFullYear();
      const m = String(date.getMonth() + 1).padStart(2, '0');
      const d = String(date.getDate()).padStart(2, '0');
      return `${y}${m}${d}`;
    }

    async function fetchGames() {
      const dateStr = getFormattedDate(currentDate);
      document.getElementById('dateDisplay').textContent = currentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      
      // Clear zones
      document.querySelectorAll('.zone').forEach(z => {
        const label = z.querySelector('.zone-label').outerHTML;
        z.innerHTML = label;
      });

      try {
        const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard?dates=${dateStr}`);
        const data = await res.json();
        const events = data.events || [];

        events.forEach(event => {
          const game = event.competitions[0];
          const home = game.competitors.find(c => c.homeAway === 'home');
          const away = game.competitors.find(c => c.homeAway === 'away');
          const status = event.status.type.state; // 'pre', 'in', 'post'
          const detail = event.status.type.detail;
          
          let targetZone = 'zone-pre';

          if (status === 'post') {
            targetZone = 'zone-post';
          } else if (status === 'in') {
            // Determine inning
            const m = detail.match(/(\d+)/);
            const inning = m ? parseInt(m[1]) : 1;
            if (inning <= 3) targetZone = 'zone-1-3';
            else if (inning <= 6) targetZone = 'zone-4-6';
            else targetZone = 'zone-7-9';
          }

          const card = document.createElement('div');
          card.className = 'game-card';
          card.onclick = () => window.open(event.links[0].href, '_blank');
          
          card.innerHTML = `
            <div class="team-line">
              <img src="${away.team.logo}" class="team-logo">
              <span class="team-abbr">${away.team.abbreviation}</span>
              <span class="score">${away.score || 0}</span>
            </div>
            <div class="team-line">
              <img src="${home.team.logo}" class="team-logo">
              <span class="team-abbr">${home.team.abbreviation}</span>
              <span class="score">${home.score || 0}</span>
            </div>
            <div class="status-line ${status === 'in' ? 'live' : ''}">
              ${status === 'pre' ? new Date(event.date).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) : detail}
            </div>
          `;

          document.getElementById(targetZone).appendChild(card);
        });

      } catch (err) {
        console.error("Fetch error:", err);
      }
    }

    fetchGames();
    setInterval(fetchGames, 30000); // Refresh every 30s
  </script>
</body>
</html>

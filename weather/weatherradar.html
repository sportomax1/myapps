<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Weather Radar | Windy</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --card-bg: #1c1c1e;
            --text: #ffffff;
            --accent: #0a84ff;
            --separator: #38383a;
            --header-h: 60px;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            height: var(--header-h);
            background: rgba(20, 20, 22, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 0.5px solid var(--separator);
            display: flex;
            align-items: center;
            padding: 0 16px;
            justify-content: space-between;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 800;
            font-size: 18px;
            letter-spacing: -0.5px;
        }

        .controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        select, button {
            background: var(--card-bg);
            border: 0.5px solid var(--separator);
            color: var(--text);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        select:hover, button:hover {
            background: #2c2c2e;
            border-color: var(--accent);
        }

        button:active {
            transform: scale(0.95);
        }

        .zoom-controls {
            display: flex;
            gap: 4px;
            margin-left: 12px;
            border-left: 1px solid var(--separator);
            padding-left: 12px;
        }

        .radar-container {
            flex: 1;
            position: relative;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .loading-overlay {
            position: absolute;
            inset: 0;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            transition: opacity 0.5s;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--separator);
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .logo span { display: none; }
            header { padding: 0 8px; }
            select { max-width: 100px; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">
            <span style="font-size: 24px;">ðŸ“¡</span>
            <span>WeatherRadar</span>
        </div>

        <div class="controls">
            <button onclick="setView('USA')">USA</button>
            <button onclick="setView('Colorado')">Colorado</button>
            
            <select id="stateSelect" onchange="setView(this.value)">
                <option value="" disabled selected>Other States</option>
                <!-- JS will populate -->
            </select>

            <div class="zoom-controls">
                <button onclick="adjustZoom(1)" title="Zoom In">âž•</button>
                <button onclick="adjustZoom(-1)" title="Zoom Out">âž–</button>
            </div>
        </div>
    </header>

    <div class="radar-container">
        <div id="loading" class="loading-overlay">
            <div class="spinner"></div>
            <p style="margin-top: 16px; font-weight: 600; color: var(--accent);">Syncing Radar...</p>
        </div>
        <iframe id="windyFrame" src=""></iframe>
    </div>

    <script>
        const states = {
            'USA': { lat: 39.8283, lon: -98.5795, zoom: 4 },
            'Alabama': { lat: 32.3182, lon: -86.9023, zoom: 7 },
            'Alaska': { lat: 63.5888, lon: -154.4931, zoom: 4 },
            'Arizona': { lat: 34.0489, lon: -111.0937, zoom: 7 },
            'Arkansas': { lat: 34.9697, lon: -92.3731, zoom: 7 },
            'California': { lat: 36.7783, lon: -119.4179, zoom: 6 },
            'Colorado': { lat: 39.5501, lon: -105.7821, zoom: 7 },
            'Connecticut': { lat: 41.6032, lon: -73.0877, zoom: 9 },
            'Delaware': { lat: 38.9108, lon: -75.5277, zoom: 9 },
            'Florida': { lat: 27.6648, lon: -81.5158, zoom: 7 },
            'Georgia': { lat: 32.1656, lon: -82.9001, zoom: 7 },
            'Hawaii': { lat: 19.8968, lon: -155.5828, zoom: 7 },
            'Idaho': { lat: 44.0682, lon: -114.742, zoom: 7 },
            'Illinois': { lat: 40.6331, lon: -89.3985, zoom: 7 },
            'Indiana': { lat: 40.2672, lon: -86.1349, zoom: 7 },
            'Iowa': { lat: 41.878, lon: -93.0977, zoom: 7 },
            'Kansas': { lat: 39.0119, lon: -98.4842, zoom: 7 },
            'Kentucky': { lat: 37.8393, lon: -84.27, zoom: 7 },
            'Louisiana': { lat: 30.9843, lon: -91.9623, zoom: 7 },
            'Maine': { lat: 45.2538, lon: -69.4455, zoom: 7 },
            'Maryland': { lat: 39.0458, lon: -76.6413, zoom: 8 },
            'Massachusetts': { lat: 42.4072, lon: -71.3824, zoom: 8 },
            'Michigan': { lat: 44.3148, lon: -85.6024, zoom: 7 },
            'Minnesota': { lat: 46.7296, lon: -94.6859, zoom: 7 },
            'Mississippi': { lat: 32.3547, lon: -89.3985, zoom: 7 },
            'Missouri': { lat: 37.9643, lon: -91.8318, zoom: 7 },
            'Montana': { lat: 46.8797, lon: -110.3626, zoom: 7 },
            'Nebraska': { lat: 41.4925, lon: -99.9018, zoom: 7 },
            'Nevada': { lat: 38.8026, lon: -116.4194, zoom: 7 },
            'New Hampshire': { lat: 43.1939, lon: -71.5724, zoom: 8 },
            'New Jersey': { lat: 40.0583, lon: -74.4057, zoom: 8 },
            'New Mexico': { lat: 34.5199, lon: -105.8701, zoom: 7 },
            'New York': { lat: 40.7128, lon: -74.006, zoom: 7 },
            'North Carolina': { lat: 35.7596, lon: -79.0193, zoom: 7 },
            'North Dakota': { lat: 47.5515, lon: -101.002, zoom: 7 },
            'Ohio': { lat: 40.4173, lon: -82.9071, zoom: 7 },
            'Oklahoma': { lat: 35.0078, lon: -97.0929, zoom: 7 },
            'Oregon': { lat: 43.8041, lon: -120.5542, zoom: 7 },
            'Pennsylvania': { lat: 41.2033, lon: -77.1945, zoom: 7 },
            'Rhode Island': { lat: 41.5801, lon: -71.4774, zoom: 10 },
            'South Carolina': { lat: 33.8361, lon: -81.1637, zoom: 7 },
            'South Dakota': { lat: 44.3683, lon: -100.351, zoom: 7 },
            'Tennessee': { lat: 35.5175, lon: -86.5804, zoom: 7 },
            'Texas': { lat: 31.9686, lon: -99.9018, zoom: 6 },
            'Utah': { lat: 39.321, lon: -111.0937, zoom: 7 },
            'Vermont': { lat: 44.5588, lon: -72.5778, zoom: 8 },
            'Virginia': { lat: 37.4316, lon: -78.6569, zoom: 7 },
            'Washington': { lat: 47.7511, lon: -120.7401, zoom: 7 },
            'West Virginia': { lat: 38.5976, lon: -80.4549, zoom: 8 },
            'Wisconsin': { lat: 43.7844, lon: -88.7879, zoom: 7 },
            'Wyoming': { lat: 43.076, lon: -107.2903, zoom: 7 }
        };

        let currentView = { ...states['USA'] };
        const frame = document.getElementById('windyFrame');
        const loading = document.getElementById('loading');
        const select = document.getElementById('stateSelect');

        // Populate dropdown
        Object.keys(states).sort().forEach(state => {
            if (state !== 'USA' && state !== 'Colorado') {
                const opt = document.createElement('option');
                opt.value = state;
                opt.textContent = state;
                select.appendChild(opt);
            }
        });

        function updateFrame() {
            loading.style.opacity = '1';
            loading.style.display = 'flex';
            
            // Updated Windy Embed URL using embed2.html and correct radar parameters
            const url = `https://embed.windy.com/embed2.html?lat=${currentView.lat}&lon=${currentView.lon}&zoom=${currentView.zoom}&level=radar&overlay=radar&menu=&message=true&marker=false&calendar=now&pressure=&type=map&location=coordinates&detail=&detailLat=${currentView.lat}&detailLon=${currentView.lon}&metricWind=default&metricTemp=default&radarRange=-1`;
            
            frame.src = url;

            // Simple timeout to hide loading since we can't always detect iframe load cross-origin
            setTimeout(() => {
                loading.style.opacity = '0';
                setTimeout(() => loading.style.display = 'none', 500);
            }, 2500);
        }

        function setView(name) {
            if (states[name]) {
                currentView = { ...states[name] };
                updateFrame();
            }
        }

        function adjustZoom(delta) {
            currentView.zoom = Math.max(2, Math.min(18, currentView.zoom + delta));
            updateFrame();
        }

        // Handle iframe load event
        frame.onload = () => {
            loading.style.opacity = '0';
            setTimeout(() => loading.style.display = 'none', 500);
        };

        // Initial Load
        setView('USA');
    </script>
</body>
</html>
